<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv='Content-type' content='text/html; charset=utf-8'>
    <title>Basic Example</title>
    <link rel="stylesheet" href="shared/css/base.css" />
  </head>
  <body>
    <div id="container">
      <p>
        To install React, follow the instructions on
        <a href="http://www.github.com/facebook/react/">GitHub</a>.
      </p>
      <p>
        If you can see this, React is not working right.
        If you checked out the source from GitHub make sure to run <code>grunt</code>.
      </p>
    </div>
    
    <script src="shared/thirdparty/es5-shim.min.js"></script>
    <script src="shared/thirdparty/es5-sham.min.js"></script>
    <script src="shared/thirdparty/console-polyfill.js"></script>
    <script src="build/react.js"></script>
    <script src="src/utils.js"></script>
    <script src="src/geodata.js"></script>
    <script type="text/jsx">
      var GeoDistance = React.createClass({
        getInitialState: function() {
          return {
            distance: null
          };
        },
        handleSubmit: function(e) {
          e.preventDefault();
          console.log(this.refs);
          this.setState({
            distance: this.calculateDistance(
              {
                latitude: parseFloat(React.findDOMNode(this.refs['point1.latitude']).value, 10),
                longitude: parseFloat(React.findDOMNode(this.refs['point1.longitude']).value, 10)
              },
              {
                latitude: parseFloat(React.findDOMNode(this.refs['point2.latitude']).value, 10),
                longitude: parseFloat(React.findDOMNode(this.refs['point2.longitude']).value, 10)
              }
            )
          });
        },
        calculateDistance: function(point1, point2) {
          console.log(point1, point2);
          var geodata = new Geodata(point1);
          return geodata.distance(point2);
        },
        render: function() {
          return (
            <form onSubmit={this.handleSubmit}>
              <div>
                Point 1:
                <input type="text" ref="point1.latitude" value="52.3532884" />
                <input type="text" ref="point1.longitude" value="4.8407814" />
              </div>
              <div>
                Point 2:
                <input type="text" ref="point2.latitude" value="52.3865138" />
                <input type="text" ref="point2.longitude" value="4.8697248" />
              </div>
              <button>Calculate</button>
              <div>Distance: {this.state.distance}</div>
            </form>
          );
        }
      });

      React.render(
        <GeoDistance />,
        document.getElementById('container')
      );
    </script>
    <script src="build/JSXTransformer.js"></script>
  </body>
</html>
